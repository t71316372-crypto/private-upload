<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Supabase Debug - Bucket Check</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <h1>Supabase 接続デバッグ</h1>
  <p>コンソール（F12）を確認してください。</p>

  <script>
    const URL = "https://erdwkchgsewnzkyriypx.supabase.co";
    const KEY = "sb_publishable_p7r9MOIEw4RT7ptaJ8_Arg_nbli69_J";
    const sb = window.supabase.createClient(URL, KEY);

    // ★ ここを管理画面の表記と完全に一致させる
    const BUCKET_NAME = "images"; 

    async function run() {
      console.log("--- DEBUG START ---");
      
      try {
        // 1. バケット自体の情報を取得（名前が合っているか、公開設定かチェック）
        const { data: bucketInfo, error: bucketError } = await sb.storage.getBucket(BUCKET_NAME);
        console.log("1. BUCKET INFO:", bucketInfo);
        if (bucketError) console.error("BUCKET ERROR:", bucketError);

        // 2. ルートディレクトリをリスト取得
        console.log("2. LISTING PATH: '' (root)");
        const { data: rootData, error: rootError } = await sb.storage.from(BUCKET_NAME).list("");
        console.log("ROOT DATA:", rootData);

        // 3. もし空なら、仮に 'public/' フォルダの中も探してみる
        if (rootData && rootData.length === 0) {
          console.log("3. LISTING PATH: 'public/' (Trying subfolder)");
          const { data: subData } = await sb.storage.from(BUCKET_NAME).list("public");
          console.log("SUBFOLDER DATA:", subData);
        }

      } catch (err) {
        console.error("CRITICAL ERROR:", err);
      }
    }

    run();
  </script>
</body>
</html>
