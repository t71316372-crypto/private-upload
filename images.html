<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Images Test - Debugged</title>
</head>
<body>
  <h1>Supabase Storage Debug</h1>
  <p>Consoleを確認してください。</p>

  <script type="module">
    // ESM版を直接インポート（グローバルを汚染しない）
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm'

    const SUPABASE_URL = "https://erdwkchgsewnzkyriypx.supabase.co";
    const SUPABASE_KEY = "sb_publishable_p7r9MOIEw4RT7ptaJ8_Arg_nbli69_J"; // あなたのキー

    // 識別子の衝突を避けるため、インスタンス名は supabaseClient とする
    const supabaseClient = createClient(SUPABASE_URL, SUPABASE_KEY);

    async function testList() {
      console.log("LIST START");

      try {
        const { data, error } = await supabaseClient
          .storage
          .from("images")
          .list("", { 
            limit: 100,
            offset: 0,
            sortBy: { column: 'name', order: 'asc' }
          });

        if (error) {
          console.error("SUPABASE ERROR:", error);
        } else {
          console.log("LIST DATA SUCCESS:", data);
        }
      } catch (err) {
        console.error("UNEXPECTED ERROR:", err);
      }
    }

    // 実行
    testList();
  </script>
</body>
</html>
